<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" type="text/css" href="css/core.css" />
		<title>Exploits</title>
	</head>
	
	<body>
		<div class="page">
			<div class="container">
				<div class="header">
					<a href="contact.html" class="header-element">
						Contact
					</a>
					
					<a href="skills.html" class="header-element">
						Skills
					</a>
					
					<a href="articles.html" class="header-element">
						Articles
					</a>
					
					<a href="index.html" class="header-element">
						Home
					</a>
				</div>
				
				<h1>Exploits and vulnerabilities</h1>
				<hr>
				
				<h2>Sony PS4</h2>
				<p>
					Three part article about the complete process of hacking the console:
				</p>
				
				<ul>
					<li><a href="ps4.html">Hacking the PS4, part 1 - Introduction to PS4's security, and userland ROP</a></li>
					<li><a href="ps4-2.html">Hacking the PS4, part 2 - Userland code execution</a></li>
					<li><a href="ps4-3.html">Hacking the PS4, part 3 - Kernel exploitation</a></li>
				</ul>
				
				<p>
					<a href="dlclose-overflow.html">Analysis of <code>sys_dynlib_prepare_dlclose</code> PS4 kernel heap overflow</a>.
				</p>
				
				<br>
				
				<h2>FreeBSD kernel bugs</h2>
				<p>
					I've spent some time analysing and reporting vulnerabilities, and other general improvements, to the FreeBSD kernel. Most of these are not critical since they are only triggerable as <code>root</code>, or have other, similar limitations:
				</p>
				
				<ul>
					<li><a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=206573#c0">Improper userland pointer handling in aacraid</a></li>
					<li><a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=206585#c2">hpt_set_info buffer overflow</a></li>
					<li><a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=206648#c0">Fix double strlen in ktrstruct</a></li>
					<li><a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=206678#c0">OGIO_KEYMAP command does not restore priority level</a></li>
					<li><a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=206680#c0">kbd race attacks</a></li>
					<li><a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=206749#c0">Lack of checks on values in ELF headers in kernel linker</a></li>
				</ul>
				
				<br>
				
				<h2>Nintendo DS</h2>
				<p>
					If you are interested in learning about exploitation, then stack smash vulnerabilities in DS games are a good way to learn the basics. I have detailed the process <a href="DS-exploit-finding.html">here</a>.
				</p>
				
				<br>
				
				<h3>DARA</h3>
				<p>
					Buffer overflow exploits in DS games are ridiculously common. Did you know that <a href="https://github.com/CTurt/DARA">every single FIFA game on the DS can be used to run unsigned code</a>?
				</p>
				
				<div class="center">
					<iframe class="youtube" width="560" height="315" src="https://www.youtube.com/embed/eJLrJVGuvuc" frameborder="0" allowfullscreen></iframe>
				</div>
				
				<p>
					While checking the FIFA games for buffer overflows, I also came across numerous other bugs, including format string vulnerabilities (however they are not exploitable since the official Nitro SDK doesn't appear to support the "%n" format).
				</p>
				
				<br>
				
				<h3>Wireless exploit</h3>
				<p>
					After successfully exploiting several DS games through their save files, I tried to do something more ambitious: a wireless exploit (inspired by the <a href="https://www.youtube.com/watch?v=DuaGt83ZCiw">Over the Air Jailbreaks</a>).
				</p>
				
				<p>
					Unfortunately, communicating wirelessly with a DS proved more difficult than I'd hoped. Using some custom drivers, there are some network cards which can be used to communicate with a DS (this is how <a href="http://forwardcoding.com/dsdev/dsdev.html">Wireless Multi Boot</a> works). But I opted for DS to DS communication (NiFi) instead.
				</p>
				
				<p>
					Although the dswifi library itself doesn't support NiFi communication, there exist modifications online which can enable NiFi communication as well as WiFi. I used <a href="https://github.com/DSGameMaker/dsgmDSWiFi">dsgmDSWiFi</a>, which is part of my DS game library <a href="dsgmLib.html">dsgmLib</a>. Here's a video demonstrating NiFi communication with dsgmLib:
				</p>
				
				<div class="center">
					<iframe class="youtube" width="560" height="315" src="https://www.youtube.com/embed/7nqTS51iXI0" frameborder="0" allowfullscreen></iframe>
				</div>
				
				<p>
					I modified the dsgmLib template to come up with a quick NiFi packet dumper, <a href="https://github.com/CTurt/NiFiCapture">NiFiCapture</a>, which I used to dump the packets of several wireless DS games.
				</p>
				
				<p>
					After analysing some packets created by hosting a multiplayer game, I tried to create my own DS application which could host a multiplayer game. No games were accepting my packets though.
				</p>
				
				<p>
					I went deeper, analysing the packet frame, as well as the content; this is where the problem arose. The NiFi code appears to be sending, 'questionable' packets. I'm not an expert on the <a href="http://en.wikipedia.org/wiki/IEEE_802.11">802.11 specification</a>, but, by comparing packets send by a real game, and by a homebrew game, it is obvious that there are some differences.
				</p>
				
				<p>
					In the end, it proved too difficult to fix the issues with the homebrew NiFi code. It works fine for capturing packets from both retail, and homebrew games, as well as sending packets that can be accepted by homebrew applications, however, not for sending packets to a retail game.
				</p>
				
				<p>
					If anyone knows how to make the homebrew NiFi code send packets that more closely resemble those sent by retail games, please let me know!
				</p>
				
				<br>
				
				<h3>IQ overflow</h3>
				<p>
					Just a funny vulnerability I found in the game EA Sports Football Academy DS.
				</p>
				
				<div class="center">
					<iframe class="youtube" width="560" height="315" src="https://www.youtube.com/embed/5qTqz9VADXA" frameborder="0" allowfullscreen></iframe>
				</div>
			</div>
		</div>
	</body>
</html>
